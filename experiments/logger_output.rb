#!/usr/bin/env ruby

# This is a short demo of the logging output generated by Pluggability's logger_callback.

BEGIN {
	require 'pathname'
	basedir = Pathname.new( __FILE__ ).dirname.parent
	libdir = basedir + 'lib'
	
	$LOAD_PATH.unshift( libdir.to_s ) unless $LOAD_PATH.include?( libdir.to_s )
}

require 'pluggability'
require 'loggability'

class DataDriver
	extend Pluggability
end

# Global level
Loggability.level = :debug

# Or just Pluggability's level:
Pluggability.logger.level = :debug

DataDriver.create( 'ringbuffer' )

# $ ruby experiments/logger_output.rb 
# [2012-08-03 12:23:43.680405 89358/main] debug {} -- Loading derivative ringbuffer
# [2012-08-03 12:23:43.680504 89358/main] debug {} -- Subdirs are: [""]
# [2012-08-03 12:23:43.680553 89358/main] debug {} -- Path is: ["ringbuffer_datadriver", "ringbuffer_DataDriver", "ringbufferdatadriver", "ringbufferDataDriver", "ringbuffer"]...
# [2012-08-03 12:23:43.680587 89358/main] debug {} -- Trying ringbuffer_datadriver...
# [2012-08-03 12:23:43.682473 89358/main] debug {} -- No module at 'ringbuffer_datadriver', trying the next alternative: 'cannot load such file -- ringbuffer_datadriver'
# [2012-08-03 12:23:43.682503 89358/main] debug {} -- Trying ringbuffer_DataDriver...
# [2012-08-03 12:23:43.684548 89358/main] debug {} -- No module at 'ringbuffer_DataDriver', trying the next alternative: 'cannot load such file -- ringbuffer_DataDriver'
# [2012-08-03 12:23:43.684584 89358/main] debug {} -- Trying ringbufferdatadriver...
# [2012-08-03 12:23:43.686695 89358/main] debug {} -- No module at 'ringbufferdatadriver', trying the next alternative: 'cannot load such file -- ringbufferdatadriver'
# [2012-08-03 12:23:43.686745 89358/main] debug {} -- Trying ringbufferDataDriver...
# [2012-08-03 12:23:43.689782 89358/main] debug {} -- No module at 'ringbufferDataDriver', trying the next alternative: 'cannot load such file -- ringbufferDataDriver'
# [2012-08-03 12:23:43.689812 89358/main] debug {} -- Trying ringbuffer...
# [2012-08-03 12:23:43.691544 89358/main] debug {} -- No module at 'ringbuffer', trying the next alternative: 'cannot load such file -- ringbuffer'
# [2012-08-03 12:23:43.691571 89358/main] debug {} -- fatals = []
# [2012-08-03 12:23:43.691609 89358/main] error {} -- Couldn't find a DataDriver named 'ringbuffer': tried ["ringbuffer_datadriver", "ringbuffer_DataDriver", "ringbufferdatadriver", "ringbufferDataDriver", "ringbuffer"]
# /Users/mgranger/source/ruby/Pluggability/lib/pluggability.rb:301:in `require_derivative': Couldn't find a DataDriver named 'ringbuffer': tried ["ringbuffer_datadriver", "ringbuffer_DataDriver", "ringbufferdatadriver", "ringbufferDataDriver", "ringbuffer"] (Pluggability::PluginError)
# 	from /Users/mgranger/source/ruby/Pluggability/lib/pluggability.rb:224:in `load_derivative'
# 	from /Users/mgranger/source/ruby/Pluggability/lib/pluggability.rb:159:in `get_subclass'
# 	from /Users/mgranger/source/ruby/Pluggability/lib/pluggability.rb:133:in `create'
# 	from experiments/logger_output.rb:26:in `<main>'
